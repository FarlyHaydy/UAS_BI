======================================================================== 
ETL Task Scheduler - Started: 15/12/2025  8:00:01,65 
Using short path: C:\FILEPE~1\SECDE9~1\FILEMA~1\KECERD~1\FILETU~1\UAS\UAS_DW~1 
Docker Compose: C:\FILEPE~1\SECDE9~1\FILEMA~1\KECERD~1\FILETU~1\UAS\UAS_DW~1\docker\docker-compose.yml 
======================================================================== 
 
[1/3] Checking Docker... 
Docker version 28.4.0, build d8eb465
[2/3] Checking containers... 
NAME      IMAGE     COMMAND   SERVICE   CREATED   STATUS    PORTS
Starting containers... 
 Network dw_pariwisata_network  Creating
 Network dw_pariwisata_network  Created
 Container dw_postgres  Creating
 Container dw_postgres  Created
 Container dw_etl  Creating
 Container dw_dashboard  Creating
 Container dw_pgadmin  Creating
 Container dw_etl  Created
 Container dw_dashboard  Created
 Container dw_pgadmin  Created
 Container dw_postgres  Starting
 Container dw_postgres  Started
 Container dw_postgres  Waiting
 Container dw_postgres  Waiting
 Container dw_postgres  Waiting
 Container dw_postgres  Healthy
 Container dw_dashboard  Starting
 Container dw_postgres  Healthy
 Container dw_etl  Starting
 Container dw_postgres  Healthy
 Container dw_pgadmin  Starting
 Container dw_pgadmin  Started
 Container dw_dashboard  Started
 Container dw_etl  Started
[3/3] Running ETL... 
---------------------------------------- 

================================================================================
[2025-12-15 08:00:41.577985] ETL Started
Working Directory: /app
Script Path: /app/scripts/etl/main_etl.py
Environment: Docker
================================================================================


‚ïî==============================================================================‚ïó
‚ïë               ETL PROCESS - DW PARIWISATA JAKARTA 2025                       ‚ïë
‚ïë                    with Disaster Recovery Features                           ‚ïë
‚ïö==============================================================================‚ïù

Started at: 2025-12-15 08:00:41 WITA
‚ÑπÔ∏è  [2025-12-15 08:00:41] ETL - START: Starting full ETL process (Traditional - Transform from staging)
2025-12-15 08:00:41,583 - utils - INFO - [2025-12-15 08:00:41] ETL - START: Starting full ETL process (Traditional - Transform from staging)
‚ÑπÔ∏è  [2025-12-15 08:00:41] BACKUP - START: Running pre-ETL database backup

================================================================================
PRE-ETL BACKUP
================================================================================
üìÇ Environment: Docker
üìÇ Backup script: /app/scripts/disaster_recovery/backup_database.sh
2025-12-15 08:00:41,583 - utils - INFO - [2025-12-15 08:00:41] BACKUP - START: Running pre-ETL database backup
üîÑ Executing backup script...
2025-12-15 08:00:43,100 - utils - INFO - [2025-12-15 08:00:43] BACKUP - SUCCESS: Pre-ETL backup completed successfully
‚úÖ [2025-12-15 08:00:43] BACKUP - SUCCESS: Pre-ETL backup completed successfully
‚úÖ Pre-ETL backup completed
   Backup location: /app/data/backups/
‚úÖ Safety backup created - ETL can proceed safely

================================================================================
STEP 1: EXTRACT DATA FROM SOURCES
================================================================================
2025-12-15 08:00:43,156 - utils - INFO - [2025-12-15 08:00:43] EXTRACT - START: Reading kunjungan data from Excel
‚ÑπÔ∏è  [2025-12-15 08:00:43] EXTRACT - START: Reading kunjungan data from Excel
‚ÑπÔ∏è  [2025-12-15 08:00:43] EXTRACT - INFO: Read 400 rows from Excel
2025-12-15 08:00:43,349 - utils - INFO - [2025-12-15 08:00:43] EXTRACT - INFO: Read 400 rows from Excel
‚úÖ [2025-12-15 08:00:43] EXTRACT - SUCCESS: Extracted 400 records
‚úì Extracted 400 kunjungan records (RAW data)
2025-12-15 08:00:43,354 - utils - INFO - [2025-12-15 08:00:43] EXTRACT - SUCCESS: Extracted 400 records
2025-12-15 08:00:43,355 - utils - INFO - [2025-12-15 08:00:43] EXTRACT - START: Reading harga tiket data
‚ÑπÔ∏è  [2025-12-15 08:00:43] EXTRACT - START: Reading harga tiket data
‚ÑπÔ∏è  [2025-12-15 08:00:43] EXTRACT - INFO: Read 29 harga records from Excel
2025-12-15 08:00:43,386 - utils - INFO - [2025-12-15 08:00:43] EXTRACT - INFO: Read 29 harga records from Excel
2025-12-15 08:00:43,389 - utils - INFO - [2025-12-15 08:00:43] EXTRACT - INFO: Harga data breakdown:
‚ÑπÔ∏è  [2025-12-15 08:00:43] EXTRACT - INFO: Harga data breakdown:
‚ÑπÔ∏è  [2025-12-15 08:00:43] EXTRACT - INFO:   - Objek wisata gratis: 11
2025-12-15 08:00:43,389 - utils - INFO - [2025-12-15 08:00:43] EXTRACT - INFO:   - Objek wisata gratis: 11
2025-12-15 08:00:43,389 - utils - INFO - [2025-12-15 08:00:43] EXTRACT - INFO:   - Objek wisata berbayar: 18
‚ÑπÔ∏è  [2025-12-15 08:00:43] EXTRACT - INFO:   - Objek wisata berbayar: 18
2025-12-15 08:00:43,390 - utils - INFO - [2025-12-15 08:00:43] EXTRACT - INFO:   - Harga tiket dewasa range: Rp 2,000 - Rp 25,000
‚ÑπÔ∏è  [2025-12-15 08:00:43] EXTRACT - INFO:   - Harga tiket dewasa range: Rp 2,000 - Rp 25,000
2025-12-15 08:00:43,391 - utils - INFO - [2025-12-15 08:00:43] EXTRACT - INFO:   - Harga tiket dewasa rata-rata: Rp 8,222
‚ÑπÔ∏è  [2025-12-15 08:00:43] EXTRACT - INFO:   - Harga tiket dewasa rata-rata: Rp 8,222
2025-12-15 08:00:43,393 - utils - INFO - [2025-12-15 08:00:43] EXTRACT - SUCCESS: Extracted 29 harga records
2025-12-15 08:00:43,394 - utils - INFO - [2025-12-15 08:00:43] LOAD - START: Loading to staging_kunjungan_raw
‚úÖ [2025-12-15 08:00:43] EXTRACT - SUCCESS: Extracted 29 harga records
‚úì Extracted 29 harga records (RAW data)

================================================================================
STEP 2: LOAD RAW DATA TO STAGING
================================================================================
üí° Staging will be used for transformation (Traditional ETL)
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - START: Loading to staging_kunjungan_raw
2025-12-15 08:00:43,496 - utils - INFO - [2025-12-15 08:00:43] LOAD - SUCCESS: Loaded 400 records to staging_kunjungan_raw
‚úÖ [2025-12-15 08:00:43] LOAD - SUCCESS: Loaded 400 records to staging_kunjungan_raw
‚úì Loaded 400 RAW records to staging_kunjungan_raw
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - START: Loading to staging_harga_tiket_raw
2025-12-15 08:00:43,496 - utils - INFO - [2025-12-15 08:00:43] LOAD - START: Loading to staging_harga_tiket_raw
‚úÖ [2025-12-15 08:00:43] LOAD - SUCCESS: Loaded 29 records to staging_harga_tiket_raw
‚úì Loaded 29 RAW harga records to staging_harga_tiket_raw

================================================================================
STEP 3: BUILD DIMENSIONS FROM STAGING DATABASE
================================================================================
2025-12-15 08:00:43,504 - utils - INFO - [2025-12-15 08:00:43] LOAD - SUCCESS: Loaded 29 records to staging_harga_tiket_raw
üí° Reading data FROM staging tables using SQL queries
‚ÑπÔ∏è  [2025-12-15 08:00:43] TRANSFORM - START: Building dim_time FROM staging
2025-12-15 08:00:43,505 - utils - INFO - [2025-12-15 08:00:43] TRANSFORM - START: Building dim_time FROM staging
2025-12-15 08:00:43,523 - utils - INFO - [2025-12-15 08:00:43] TRANSFORM - SUCCESS: Built 8 time records FROM staging
‚úÖ [2025-12-15 08:00:43] TRANSFORM - SUCCESS: Built 8 time records FROM staging
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - START: Loading to dim_time
2025-12-15 08:00:43,524 - utils - INFO - [2025-12-15 08:00:43] LOAD - START: Loading to dim_time
2025-12-15 08:00:43,530 - utils - INFO - [2025-12-15 08:00:43] LOAD - SUCCESS: Inserted 0 new time records
‚úÖ [2025-12-15 08:00:43] LOAD - SUCCESS: Inserted 0 new time records
‚úì Loaded dim_time (8 records) FROM staging
2025-12-15 08:00:43,531 - utils - INFO - [2025-12-15 08:00:43] TRANSFORM - START: Building dim_objek_wisata FROM staging
‚ÑπÔ∏è  [2025-12-15 08:00:43] TRANSFORM - START: Building dim_objek_wisata FROM staging
‚úÖ [2025-12-15 08:00:43] TRANSFORM - SUCCESS: Built 29 objek wisata FROM staging
2025-12-15 08:00:43,538 - utils - INFO - [2025-12-15 08:00:43] TRANSFORM - SUCCESS: Built 29 objek wisata FROM staging
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - START: Loading to dim_objek_wisata
2025-12-15 08:00:43,539 - utils - INFO - [2025-12-15 08:00:43] LOAD - START: Loading to dim_objek_wisata
2025-12-15 08:00:43,552 - utils - INFO - [2025-12-15 08:00:43] LOAD - SUCCESS: Inserted 0 new objek wisata records
‚úÖ [2025-12-15 08:00:43] LOAD - SUCCESS: Inserted 0 new objek wisata records
‚úì Loaded dim_objek_wisata (29 records) FROM staging
‚úì dim_wisatawan already exists (2 records: Nusantara, Mancanegara)
‚ÑπÔ∏è  [2025-12-15 08:00:43] TRANSFORM - START: Transforming harga data
2025-12-15 08:00:43,552 - utils - INFO - [2025-12-15 08:00:43] TRANSFORM - START: Transforming harga data
‚ÑπÔ∏è  [2025-12-15 08:00:43] TRANSFORM - INFO: Found 29 objek wisata in database
2025-12-15 08:00:43,555 - utils - INFO - [2025-12-15 08:00:43] TRANSFORM - INFO: Found 29 objek wisata in database
2025-12-15 08:00:43,562 - utils - INFO - [2025-12-15 08:00:43] TRANSFORM - INFO: Harga data statistics:
‚ÑπÔ∏è  [2025-12-15 08:00:43] TRANSFORM - INFO: Harga data statistics:
‚ÑπÔ∏è  [2025-12-15 08:00:43] TRANSFORM - INFO:   - Total: 29, Gratis: 11, Berbayar: 18
2025-12-15 08:00:43,563 - utils - INFO - [2025-12-15 08:00:43] TRANSFORM - INFO:   - Total: 29, Gratis: 11, Berbayar: 18
2025-12-15 08:00:43,564 - utils - INFO - [2025-12-15 08:00:43] TRANSFORM - INFO:   - Average price: Rp 8,222
‚ÑπÔ∏è  [2025-12-15 08:00:43] TRANSFORM - INFO:   - Average price: Rp 8,222
‚úÖ [2025-12-15 08:00:43] TRANSFORM - SUCCESS: Transformed 29 harga records
2025-12-15 08:00:43,564 - utils - INFO - [2025-12-15 08:00:43] TRANSFORM - SUCCESS: Transformed 29 harga records
2025-12-15 08:00:43,564 - utils - INFO - [2025-12-15 08:00:43] LOAD - START: Loading to dim_price
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - START: Loading to dim_price
2025-12-15 08:00:43,565 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO: Truncating dim_price table
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO: Truncating dim_price table
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO: Inserted: 29, Updated: 0
2025-12-15 08:00:43,591 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO: Inserted: 29, Updated: 0
2025-12-15 08:00:43,592 - utils - INFO - [2025-12-15 08:00:43] LOAD - SUCCESS: Loaded 29 price records to dim_price
‚úÖ [2025-12-15 08:00:43] LOAD - SUCCESS: Loaded 29 price records to dim_price
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO: Total records in dim_price: 29
2025-12-15 08:00:43,594 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO: Total records in dim_price: 29
‚úì Loaded dim_price (29 records)

================================================================================
STEP 4: LOAD FACT TABLE FROM STAGING
================================================================================
üí° Using SQL JOIN to merge staging with dimensions
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - START: Loading to fact_kunjungan
2025-12-15 08:00:43,595 - utils - INFO - [2025-12-15 08:00:43] LOAD - START: Loading to fact_kunjungan
2025-12-15 08:00:43,597 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO: Staging stats: 400 total, 8 periodes, 29 objek, 2 wisatawan
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO: Staging stats: 400 total, 8 periodes, 29 objek, 2 wisatawan
2025-12-15 08:00:43,599 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO: dim_time: 8 records
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO: dim_time: 8 records
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO: dim_objek_wisata: 29 records
2025-12-15 08:00:43,600 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO: dim_objek_wisata: 29 records
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO: dim_wisatawan: 2 records
2025-12-15 08:00:43,601 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO: dim_wisatawan: 2 records
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO: Inserted/Updated 400 fact records
2025-12-15 08:00:43,618 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO: Inserted/Updated 400 fact records
2025-12-15 08:00:43,626 - utils - INFO - [2025-12-15 08:00:43] LOAD - SUCCESS: Loaded 400 fact records
‚úÖ [2025-12-15 08:00:43] LOAD - SUCCESS: Loaded 400 fact records
2025-12-15 08:00:43,627 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO: Staging records marked as processed
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO: Staging records marked as processed
2025-12-15 08:00:43,628 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO: Total fact_kunjungan records: 400
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO: Total fact_kunjungan records: 400
‚úì Loaded fact_kunjungan (400 records) FROM staging
  ‚úì SQL JOIN with dim_time, dim_objek_wisata, dim_wisatawan
  ‚úì Foreign key lookups completed via database
  ‚úì Staging records marked as processed

================================================================================
STEP 5: DATA QUALITY VERIFICATION
================================================================================
2025-12-15 08:00:43,629 - utils - INFO - [2025-12-15 08:00:43] LOAD - START: Verifying data quality
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - START: Verifying data quality
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO: Data quality verification:
2025-12-15 08:00:43,634 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO: Data quality verification:
2025-12-15 08:00:43,634 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO:   - dim_time: 8 records
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO:   - dim_time: 8 records
2025-12-15 08:00:43,635 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO:   - dim_objek_wisata: 29 records
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO:   - dim_objek_wisata: 29 records
2025-12-15 08:00:43,635 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO:   - dim_wisatawan: 2 records
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO:   - dim_wisatawan: 2 records
2025-12-15 08:00:43,636 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO:   - dim_price: 29 records
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO:   - dim_price: 29 records
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO:   - fact_kunjungan: 400 records
2025-12-15 08:00:43,636 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO:   - fact_kunjungan: 400 records
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO:   - staging_total: 3600 records
2025-12-15 08:00:43,637 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO:   - staging_total: 3600 records
2025-12-15 08:00:43,637 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO:   - staging_processed: 3600 records
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO:   - staging_processed: 3600 records
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO:   - staging_unprocessed: 0 records
2025-12-15 08:00:43,638 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO:   - staging_unprocessed: 0 records
‚ÑπÔ∏è  [2025-12-15 08:00:43] LOAD - INFO:   - orphan_facts: 0 records
2025-12-15 08:00:43,638 - utils - INFO - [2025-12-15 08:00:43] LOAD - INFO:   - orphan_facts: 0 records
2025-12-15 08:00:43,639 - utils - INFO - [2025-12-15 08:00:43] LOAD - SUCCESS: No orphan records found
‚úÖ [2025-12-15 08:00:43] LOAD - SUCCESS: No orphan records found

Data Warehouse Summary:
--------------------------------------------------------------------------------
  dim_time                      :          8 records
  dim_objek_wisata              :         29 records
  dim_wisatawan                 :          2 records
  dim_price                     :         29 records
  fact_kunjungan                :        400 records
  staging_total                 :      3,600 records
  staging_processed             :      3,600 records
  staging_unprocessed           :          0 records
--------------------------------------------------------------------------------

‚úÖ Data quality check passed - No orphan records

================================================================================
STEP 6: STAGING CLEANUP
================================================================================
‚úì Staging data retained for audit trail
  ‚Üí All records marked as is_processed = TRUE
‚úÖ [2025-12-15 08:00:43] ETL - SUCCESS: ETL process completed in 0m 2s

================================================================================
ETL PROCESS COMPLETED SUCCESSFULLY! ‚úÖ
Total execution time: 0m 2s
Backup location: /app/data/backups/
================================================================================
2025-12-15 08:00:43,639 - utils - INFO - [2025-12-15 08:00:43] ETL - SUCCESS: ETL process completed in 0m 2s
2025-12-15 08:00:43,639 - utils - INFO - Success notifications disabled (EMAIL_ON_SUCCESS=false)

üéâ ETL completed successfully

Exit code: 0
---------------------------------------- 
 
SUCCESS: ETL completed 
======================================================================== 
